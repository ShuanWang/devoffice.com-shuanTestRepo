function ratingDevX(n,t){function h(){function n(){var n=$(this).attr("maxLength");$("#feedbackTextCounter").text(n-$(this).val().length)}$(document).scroll(function(){o()});$("#s_ratingYes").click(function(){r=!0;$("#s_ratingSection1").hide();$("#s_ratingSection2").show()});$("#s_ratingNo").click(function(){r=!1;$("#s_ratingSection1").hide();$("#s_ratingSection2").show()});$("#s_ratingSubmit").click(function(){$("#s_ratingSection2").hide();$("#s_ratingSection3").show();f()});$("#s_ratingSkipThis").click(function(){$("#s_ratingSection2").hide();$("#s_ratingSection3").show();f()});$(".closeSmallWhite").click(function(){f()});$("#s_ratingText").keyup(n).keypress(n)}function f(){i.userPrompted=!0;i.isPageHelpful=r;i.userComments=$("#s_ratingText").val();y(JSON.stringify(i));document.cookie=u+"="+r;window.setTimeout(function(){$("#responsiveRating").removeClass("show")},1e3)}function c(){return document.cookie.indexOf(u)>-1}function o(){if(!c()){var t=l(n);t.inViewPartial&&$("#responsiveRating").addClass("show")}}function l(n){n=n[0]=="#"?n:"#"+n;var f=$(n),h=$(window),t=h.scrollTop(),r=t+window.innerHeight,i=f.offset().top,u=i+f.height(),e=i>=t&&i<=r,o=u>=t&&u<=r,c=i<=(r-t)/2,s=a(n);return{inViewFull:e&&o&&s,inViewPartial:(e||o)&&s,aboveTop:u<=t,belowBottom:i>=r,aboveMiddle:c}}function a(n){n=n[0]=="#"?n:"#"+n;var t=$(n);return $(t).is(":visible")}function v(n,t){var i=document.createElement("script");i.type="text/javascript";i.readyState?i.onreadystatechange=function(){(i.readyState=="loaded"||i.readyState=="complete")&&(i.onreadystatechange=null,typeof t=="function"&&t())}:i.onload=function(){typeof t=="function"&&t()};i.src=n;document.getElementsByTagName("head")[0].appendChild(i)}function s(n){v("https://appsforoffice.microsoft.com/telemetry/lib/1.0/hosted/AppsTelemetry.js",function(){var t={};t.appVersion="1.0";AppsTelemetry.initialize("ratingDevX",t);n!=undefined&&n()})}function y(n){AppsTelemetry!=undefined?AppsTelemetry.sendLog(AppsTelemetry.TraceLevel.info,n):s(function(){AppsTelemetry.sendLog(AppsTelemetry.TraceLevel.info,n)})}var r,e=document.location.href.split("\\").pop().split("/").pop().split("?")[0].split("#")[0],u="ratingDevX-"+e,i={page:e,pageProgress:"",userPrompted:!1,isPageHelpful:undefined,userComments:""};this.init=function(){$(document).ready(function(){var i=$("#"+n).append($("<div id='ratingDevX'><\/div>"));$("#ratingDevX").load(t+"/rating.html",function(){h();o()});$("head").append($("<link rel='stylesheet' href='"+t+"/rating.css' type='text/css'/>"))});s()};this.updateProgress=function(n){i.pageProgress=n};this.clearCookie=function(){document.cookie=u+"=; expires=Thu, 01 Jan 1970 00:00:01 GMT;"};this.init()}
//# sourceMappingURL=rating.min.js.map
