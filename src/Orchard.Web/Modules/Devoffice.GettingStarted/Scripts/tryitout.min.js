function TryItOut(n,t){function w(n){for(var u,r="",t=0;t<i.length;++t)u="value = "+t,r+="<option value ='"+t+"'>"+i[t].name+"<\/option>";n.html(r)}function c(){k(p);$(o).text("");$("#tryError").html("");a();$("#invokeurlBtn").prop("disabled",!1).css("cursor","pointer")}function a(){var n=b(!0);l.html(n)}function b(){var o=r.val(),s=h.val(),t=i[o],f,u,n;return s==="sample_data"?f=t.serviceEndPointUri:(e==null&&v(),e!=null&&(f=e[t.serviceName])),u=f+t.urlpart,t.parameters.length>0&&(n=$("#paramTable .textbox").val(),(n===undefined||n==null||n=="")&&(n=t.parameters[0].Value),u=u.replace("{0}",n)),u}function k(n){var h=r.val(),u=i[h].parameters,o,f,t,s,e;if(u.length===0){$(n).empty();return}for(o="<thead><td>Name<\/td><td>Type<\/td><td>Value<\/td><td>Notes<\/td><\/thead>",f="",t=0;t<u.length;++t){var c="<td>"+u[t].Name+"<\/td>",l="<td>"+u[t].Type+"<\/td>",v="<td><input class='textbox' type='text' value= "+u[t].Value+" /><\/td>",y="<td>"+u[t].Notes+"<\/td>";f+="<tr>"+c+l+v+y+"<\/tr>"}s="<table id='paramTable' class='table'>"+o+f+"<\/table>";e=$(n);e.empty();e.append(s);$("#paramTable .textbox").focusout(function(){var n=$("#paramTable .textbox").val(),t;if(n==""||typeof n===undefined){$("#tryError").html("Please enter a parameter");$("#invokeurlBtn").prop("disabled",!0).css("cursor","default");return}a();t=new RegExp(/^.*?(?=[\^#&$\*:<>\?/\{\|\}]).*$/);t.test(n)&&($("#tryError").html("<bold>parameter contains at least one invalid chars<\/bold>"),$("#invokeurlBtn").prop("disabled",!0).css("cursor","default"))});$("#paramTable .textbox").focus(function(){$("#tryError").html("");$("#invokeurlBtn").prop("disabled",!1).css("cursor","pointer");return})}function v(){var n=$("#tryError");n.html("Getting the service endpoint...");$.ajax({url:"/gettingstarted/proxy/EndPoints",async:!1,type:"GET",success:function(t){n.html("");e=t},error:function(){n.html("<div class='ms-font-color-error ms-font-m'>Encountered error while requesting service endpoint, Please login and try again<\/div>")},complete:function(){}})}function d(){function t(t,i,r){n+=r?JSON.stringify(i):i}var u,n;$("#response-container").show("slow");f.prop("disabled",!0).css("cursor","default");s.addClass("loading");var c=r.val(),l=i[c],e=l.serverAction,h=$("#paramTable .textbox").val();typeof h!="undefined"&&(e+="/"+h);u=JSON.parse("{}");u.Accept="application/json";n="";$.ajax({url:e,type:"GET",headers:u,success:function(i,r,u){t(n,i,!0);resultStatus=u.status},error:function(i){if(t(n,"Error...",!1),i.status===0){t(n,"The request has been cancelled, please login and try again",!1);return}t(n,i.responseText,!1);return},complete:function(){s.removeClass("loading");o.jsonView(n);f.prop("disabled",!1).css("cursor","pointer")}})}function g(n){function u(n,i,r){t+=r?JSON.stringify(i):i}var c,t;$("#response-container").show("slow");f.prop("disabled",!0).css("cursor","default");s.addClass("loading");var l=$(r).val(),a=i[l].authToken,h="",e=JSON.parse("{}");e.Accept="application/json";e.Authorization=a;e["ApiExProxy-FixedAadUser"]=1;c="https://apiexproxy.azurewebsites.net/svc?url="+n;t="";$.ajax({url:c,type:"GET",headers:e,success:function(n,i,r){u(t,n,!0);h=r.status},error:function(n,i){var r,f;if(i==="timeout"){u(t,"Timeout occurred...",!1);return}if(r=n.getResponseHeader("ApiExProxy-Error"),n.status=="0"||r!=null&&r!="0")u(t,"Proxy not reachable",!1);else try{f=$.parseJSON(n.responseText);u(t,f,!0);h=n.status}catch(e){u(t,"Unexpected Error occured",!1)}},complete:function(){s.removeClass("loading");o.jsonView(t);f.prop("disabled",!1).css("cursor","pointer")}})}var e,i=[{name:"Mail API: Get messages",serviceName:"Mail",serviceEndPointUri:"https://outlook.office365.com/api/v1.0",urlpart:"/me/folders/{0}/messages",serverAction:"/GettingStarted/Proxy/EMail",authToken:"Bearer {token:https://outlook.office365.com/}",parameters:[{Name:"folder_id",Type:"string",Value:"sentitems",Notes:"The target folder ID or well-known name: Inbox, SentItems, Drafts, or DeletedItems."}]},{name:"Calendar API: Get events",serviceName:"Calendar",serviceEndPointUri:"https://outlook.office365.com/api/v1.0",urlpart:"/me/events",serverAction:"/GettingStarted/Proxy/Events",authToken:"Bearer {token:https://outlook.office365.com/}",parameters:[]},{name:"Contacts API: Get all contacts",serviceName:"Contacts",serviceEndPointUri:"https://outlook.office365.com/api/v1.0",urlpart:"/me/contacts",serverAction:"/GettingStarted/Proxy/Contacts",authToken:"Bearer {token:https://outlook.office365.com/}",parameters:[]},{name:"Files API: List folder contents",serviceName:"MyFiles",serviceEndPointUri:"https://a830edad9050849NDA1-my.sharepoint.com/_api/v1.0/me",urlpart:"/files/getByPath('{0}')/children",serverAction:"/GettingStarted/Proxy/ListFolderContents",authToken:"Bearer {token:https://a830edad9050849NDA1-my.sharepoint.com/}",parameters:[{Name:"folder-path",Type:"string",Value:"Shared%20with%20Everyone",Notes:"Path of the folder."}]},],u=n,y=t,r=$("#"+u.services),l=$("#"+u.urlValue),o=$("#"+u.responseBody),p=$("#"+u.parameterDetails),f=$("#"+u.invokeurlBtn),s=$("."+y.CodeContainer),h=$("#"+u.sandBoxOptions);w(r);r.on("change",function(){c()});h.on("change",function(){c()});f.on("click",function(){var t=l.text(),n;o.text("");n=h.val();n==="sample_data"?g(t):d();ga("send","event","O365path-Rest","TryOut-"+n+"-"+i[r.val()].name)});c();$.ajax({url:"/GettingStarted/Account/IsAuthenticated",async:!0,type:"GET",success:function(n){n=="True"&&v()}})}
//# sourceMappingURL=tryitout.min.js.map
