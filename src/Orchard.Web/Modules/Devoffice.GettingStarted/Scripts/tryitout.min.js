function TryItOut(n,t,i){function b(n){for(var f,u="",t=0;t<r.length;++t)f=r[t].App,(i==null||i==""||f.indexOf(i)>-1)&&(u+="<option value ='"+t+"'>"+r[t].name+"<\/option>");n.html(u)}function l(){d(w);$(s).text("");$("#tryError").html("");v();$("#invokeurlBtn").prop("disabled",!1).css("cursor","pointer")}function v(){var n=k(!0);a.html(n)}function k(){var e=f.val(),s=c.val(),t=r[e],u,i,n;return s==="sample_data"?u=t.serviceEndPointUri:(o==null&&y(),o!=null&&(u=o[t.serviceName])),i=u+t.urlpart,t.parameters.length>0&&(n=$("#paramTable .textbox").val(),(n===undefined||n==null||n=="")&&(n=t.parameters[0].Value),i=i.replace("{0}",n)),i}function d(n){var h=f.val(),i=r[h].parameters,o,u,t,s,e;if(i.length===0){$(n).empty();return}for(o="<thead><td>Name<\/td><td>Type<\/td><td>Value<\/td><td>Notes<\/td><\/thead>",u="",t=0;t<i.length;++t){var c="<td>"+i[t].Name+"<\/td>",l="<td>"+i[t].Type+"<\/td>",a="<td><input class='textbox' type='text' value= "+i[t].Value+" /><\/td>",y="<td>"+i[t].Notes+"<\/td>";u+="<tr>"+c+l+a+y+"<\/tr>"}s="<table id='paramTable' class='table'>"+o+u+"<\/table>";e=$(n);e.empty();e.append(s);$("#paramTable .textbox").focusout(function(){var n=$("#paramTable .textbox").val(),t;if(n==""||typeof n===undefined){$("#tryError").html("Please enter a parameter");$("#invokeurlBtn").prop("disabled",!0).css("cursor","default");return}v();t=new RegExp(/^.*?(?=[\^#&$\*:<>\?/\{\|\}]).*$/);t.test(n)&&($("#tryError").html("<bold>parameter contains at least one invalid chars<\/bold>"),$("#invokeurlBtn").prop("disabled",!0).css("cursor","default"))});$("#paramTable .textbox").focus(function(){$("#tryError").html("");$("#invokeurlBtn").prop("disabled",!1).css("cursor","pointer");return})}function y(){var n=$("#tryError");n.html("Getting the service endpoint...");ga("send","event","O365path-Rest","Try-it-out-GetServiceEndPoint-Begin");$.ajax({url:"/gettingstarted/proxy/EndPoints",async:!1,type:"GET",success:function(t){n.html("");o=t;ga("send","event","O365path-Rest","Try-it-out-GetServiceEndPoint-Success")},error:function(t){n.html("<div class='ms-font-color-error ms-font-m'>Encountered error while requesting service endpoint, Please login and try again<\/div>");ga("send","event","O365path-Rest","Try-it-out-GetServiceEndPoint-Error-"+t.responseText)},complete:function(){}})}function g(){function i(t,i,r){n+=r?JSON.stringify(i):i}var u,n;$("#response-container").show("slow");e.prop("disabled",!0).css("cursor","default");h.addClass("loading");var c=f.val(),l=r[c],t=l.serverAction,o=$("#paramTable .textbox").val();typeof o!="undefined"&&(t+="/"+o);u=JSON.parse("{}");u.Accept="application/json";n="";ga("send","event","O365path-Rest","Try-it-out-invokeUrlOnUserData-"+t+"-Begin");$.ajax({url:t,type:"GET",headers:u,success:function(r,u,f){i(n,r,!0);resultStatus=f.status;ga("send","event","O365path-Rest","Try-it-out-invokeUrlOnUserData-"+t+"-Success")},error:function(r){if(i(n,"Error...",!1),r.status===0){i(n,"The request has been cancelled, please login and try again",!1);ga("send","event","O365path-Rest","Try-it-out-invokeUrlOnUserData-"+t+"-Error-Request has been cancelled");return}i(n,r.responseText,!1);ga("send","event","O365path-Rest","Try-it-out-invokeUrlOnUserData-"+t+"-Error-"+r.responseText);return},complete:function(){h.removeClass("loading");s.jsonView(n);e.prop("disabled",!1).css("cursor","pointer")}})}function nt(n){function i(n,i,r){t+=r?JSON.stringify(i):i}var c,t;$("#response-container").show("slow");e.prop("disabled",!0).css("cursor","default");h.addClass("loading");var l=$(f).val(),a=r[l].authToken,o="",u=JSON.parse("{}");u.Accept="application/json";u.Authorization=a;u["ApiExProxy-FixedAadUser"]=1;c="https://apiexproxy.azurewebsites.net/svc?url="+n;t="";ga("send","event","O365path-Rest","Try-it-out-invokeUrlOnSampleData-"+n+"-Begin");$.ajax({url:c,type:"GET",headers:u,success:function(r,u,f){i(t,r,!0);o=f.status;ga("send","event","O365path-Rest","Try-it-out-invokeUrlOnSampleData-"+n+"-Success")},error:function(r,u){var f,e;if(u==="timeout"){i(t,"Timeout occurred...",!1);ga("send","event","O365path-Rest","Try-it-out-invokeUrlOnSampleData-"+n+"-Error-TimeoutError");return}if(f=r.getResponseHeader("ApiExProxy-Error"),r.status=="0"||f!=null&&f!="0")i(t,"Proxy not reachable",!1),ga("send","event","O365path-Rest","Try-it-out-invokeUrlOnSampleData-"+n+"-Error-ProxyNotReachable");else try{e=$.parseJSON(r.responseText);i(t,e,!0);o=r.status;ga("send","event","O365path-Rest","Try-it-out-invokeUrlOnSampleData-"+n+"-Error-"+e)}catch(s){i(t,"Unexpected Error occured",!1);ga("send","event","O365path-Rest","Try-it-out-invokeUrlOnSampleData-"+n+"-Error-Unexpected Service Error")}},complete:function(){h.removeClass("loading");s.jsonView(t);e.prop("disabled",!1).css("cursor","pointer")}})}var o,r=[{name:"Mail API: Get messages",App:"outlook",serviceName:"Mail",serviceEndPointUri:"https://outlook.office365.com/api/v1.0",urlpart:"/me/folders/{0}/messages",serverAction:"/GettingStarted/Proxy/EMail",authToken:"Bearer {token:https://outlook.office365.com/}",parameters:[{Name:"folder_id",Type:"string",Value:"sentitems",Notes:"The target folder ID or well-known name: Inbox, SentItems, Drafts, or DeletedItems."}]},{name:"Calendar API: Get events",App:"outlook",serviceName:"Calendar",serviceEndPointUri:"https://outlook.office365.com/api/v1.0",urlpart:"/me/events",serverAction:"/GettingStarted/Proxy/Events",authToken:"Bearer {token:https://outlook.office365.com/}",parameters:[]},{name:"Contacts API: Get all contacts",App:"outlook",serviceName:"Contacts",serviceEndPointUri:"https://outlook.office365.com/api/v1.0",urlpart:"/me/contacts",serverAction:"/GettingStarted/Proxy/Contacts",authToken:"Bearer {token:https://outlook.office365.com/}",parameters:[]},{name:"Files API: List folder contents",App:"onedrive",serviceName:"MyFiles",serviceEndPointUri:"https://a830edad9050849NDA1-my.sharepoint.com/_api/v1.0/me",urlpart:"/files/getByPath('{0}')/children",serverAction:"/GettingStarted/Proxy/ListFolderContents",authToken:"Bearer {token:https://a830edad9050849NDA1-my.sharepoint.com/}",parameters:[{Name:"folder-path",Type:"string",Value:"Shared%20with%20Everyone",Notes:"Path of the folder."}]},],u=n,p=t,f=$("#"+u.services),a=$("#"+u.urlValue),s=$("#"+u.responseBody),w=$("#"+u.parameterDetails),e=$("#"+u.invokeurlBtn),h=$("."+p.CodeContainer),c=$("#"+u.sandBoxOptions);b(f);f.on("change",function(){l()});c.on("change",function(){l()});e.on("click",function(){var t=a.text(),n;s.text("");n=c.val();n==="sample_data"?nt(t):g()});l();$.ajax({url:"/GettingStarted/Account/IsAuthenticated",async:!0,type:"GET",success:function(n){n=="True"&&y()}})}
//# sourceMappingURL=tryitout.min.js.map
