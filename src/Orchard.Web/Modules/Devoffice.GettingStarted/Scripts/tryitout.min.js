function TryItOut(n,t){function w(n){for(var u,r="",t=0;t<i.length;++t)u="value = "+t,r+="<option value ='"+t+"'>"+i[t].name+"<\/option>";n.html(r)}function c(){k(p);$(o).text("");$("#tryError").html("");a();$("#invokeurlBtn").prop("disabled",!1).css("cursor","pointer")}function a(){var n=b(!0);l.html(n)}function b(){var o=u.val(),s=h.val(),t=i[o],f,r,n;return s==="sample_data"?f=t.serviceEndPointUri:(e==null&&v(),e!=null&&(f=e[t.serviceName])),r=f+t.urlpart,t.parameters.length>0&&(n=$("#paramTable .textbox").val(),(n===undefined||n==null||n=="")&&(n=t.parameters[0].Value),r=r.replace("{0}",n)),r}function k(n){var h=u.val(),r=i[h].parameters,o,f,t,s,e;if(r.length===0){$(n).empty();return}for(o="<thead><td>Name<\/td><td>Type<\/td><td>Value<\/td><td>Notes<\/td><\/thead>",f="",t=0;t<r.length;++t){var c="<td>"+r[t].Name+"<\/td>",l="<td>"+r[t].Type+"<\/td>",v="<td><input class='textbox' type='text' value= "+r[t].Value+" /><\/td>",y="<td>"+r[t].Notes+"<\/td>";f+="<tr>"+c+l+v+y+"<\/tr>"}s="<table id='paramTable' class='table'>"+o+f+"<\/table>";e=$(n);e.empty();e.append(s);$("#paramTable .textbox").focusout(function(){var n=$("#paramTable .textbox").val(),t;if(n==""||typeof n===undefined){$("#tryError").html("Please enter a parameter");$("#invokeurlBtn").prop("disabled",!0).css("cursor","default");return}a();t=new RegExp(/^.*?(?=[\^#&$\*:<>\?/\{\|\}]).*$/);t.test(n)&&($("#tryError").html("<bold>parameter contains at least one invalid chars<\/bold>"),$("#invokeurlBtn").prop("disabled",!0).css("cursor","default"))});$("#paramTable .textbox").focus(function(){$("#tryError").html("");$("#invokeurlBtn").prop("disabled",!1).css("cursor","pointer");return})}function v(){var n=$("#tryError");n.html("Getting the service endpoint...");ga("send","event","O365path-Rest","Try-it-out-GetServiceEndPoint-Begin");$.ajax({url:"/gettingstarted/proxy/EndPoints",async:!1,type:"GET",success:function(t){n.html("");e=t;ga("send","event","O365path-Rest","Try-it-out-GetServiceEndPoint-Success")},error:function(t){n.html("<div class='ms-font-color-error ms-font-m'>Encountered error while requesting service endpoint, Please login and try again<\/div>");ga("send","event","O365path-Rest","Try-it-out-GetServiceEndPoint-Error-"+t.responseText);MscomCustomEvent("ms.InteractionType","4","ms.controlname","O365apis","ms.ea_action","Try-it-out-GetServiceEndPoint-Error","ms.callresult",t.responseText)},complete:function(){}})}function d(){function r(n,i,r){t+=r?JSON.stringify(i):i}var e,t;$("#response-container").show("slow");f.prop("disabled",!0).css("cursor","default");s.addClass("loading");var c=u.val(),l=i[c],n=l.serverAction,h=$("#paramTable .textbox").val();typeof h!="undefined"&&(n+="/"+h);e=JSON.parse("{}");e.Accept="application/json";t="";ga("send","event","O365path-Rest","Try-it-out-invokeUrlOnUserData-"+n+"-Begin");$.ajax({url:n,type:"GET",headers:e,success:function(i,u,f){r(t,i,!0);resultStatus=f.status;ga("send","event","O365path-Rest","Try-it-out-invokeUrlOnUserData-"+n+"-Success");MscomCustomEvent("ms.InteractionType","4","ms.controlname","O365apis","ms.ea_action","Try-it-out-invokeUrlOnUserData-Success","ms.contentproperties",n)},error:function(i){if(r(t,"Error...",!1),i.status===0){r(t,"The request has been cancelled, please login and try again",!1);ga("send","event","O365path-Rest","Try-it-out-invokeUrlOnUserData-"+n+"-Error-Request has been cancelled");MscomCustomEvent("ms.InteractionType","4","ms.controlname","O365apis","ms.ea_action","Try-it-out-invokeUrlOnUserData-Error","ms.contentproperties",n,"ms.callresult","Request has been cancelled");return}r(t,i.responseText,!1);ga("send","event","O365path-Rest","Try-it-out-invokeUrlOnUserData-"+n+"-Error-"+i.responseText);MscomCustomEvent("ms.InteractionType","4","ms.controlname","O365apis","ms.ea_action","Try-it-out-invokeUrlOnUserData-Error","ms.contentproperties",n,"ms.callresult",i.responseText);return},complete:function(){s.removeClass("loading");o.jsonView(t);f.prop("disabled",!1).css("cursor","pointer")}})}function g(n){function r(n,i,r){t+=r?JSON.stringify(i):i}var c,t;$("#response-container").show("slow");f.prop("disabled",!0).css("cursor","default");s.addClass("loading");var l=$(u).val(),a=i[l].authToken,h="",e=JSON.parse("{}");e.Accept="application/json";e.Authorization=a;e["ApiExProxy-FixedAadUser"]=1;c="https://apiexproxy.azurewebsites.net/svc?url="+n;t="";ga("send","event","O365path-Rest","Try-it-out-invokeUrlOnSampleData-"+n+"-Begin");$.ajax({url:c,type:"GET",headers:e,success:function(i,u,f){r(t,i,!0);h=f.status;ga("send","event","O365path-Rest","Try-it-out-invokeUrlOnSampleData-"+n+"-Success");MscomCustomEvent("ms.InteractionType","4","ms.controlname","O365apis","ms.ea_action","Try-it-out-invokeUrlOnSampleData-Success","ms.contentproperties",n)},error:function(i,u){var e,f;if(u==="timeout"){r(t,"Timeout occurred...",!1);ga("send","event","O365path-Rest","Try-it-out-invokeUrlOnSampleData-"+n+"-Error-TimeoutError");MscomCustomEvent("ms.InteractionType","4","ms.controlname","O365apis","ms.ea_action","Try-it-out-invokeUrlOnSampleData-Error","ms.contentproperties",n,"ms.callresult","TimeoutError");return}if(e=i.getResponseHeader("ApiExProxy-Error"),i.status=="0"||e!=null&&e!="0")r(t,"Proxy not reachable",!1),ga("send","event","O365path-Rest","Try-it-out-invokeUrlOnSampleData-"+n+"-Error-ProxyNotReachable"),MscomCustomEvent("ms.InteractionType","4","ms.controlname","O365apis","ms.ea_action","Try-it-out-invokeUrlOnSampleData-Error","ms.contentproperties",n,"ms.callresult","ProxyNotReachable");else try{f=$.parseJSON(i.responseText);r(t,f,!0);h=i.status;ga("send","event","O365path-Rest","Try-it-out-invokeUrlOnSampleData-"+n+"-Error-"+f);MscomCustomEvent("ms.InteractionType","4","ms.controlname","O365apis","ms.ea_action","Try-it-out-invokeUrlOnSampleData-Error","ms.contentproperties",n,"ms.callresult",f)}catch(o){r(t,"Unexpected Error occured",!1);ga("send","event","O365path-Rest","Try-it-out-invokeUrlOnSampleData-"+n+"-Error-Unexpected Service Error");MscomCustomEvent("ms.InteractionType","4","ms.controlname","O365apis","ms.ea_action","Try-it-out-invokeUrlOnSampleData-Error","ms.contentproperties",n,"ms.callresult","Unexpected Service Error")}},complete:function(){s.removeClass("loading");o.jsonView(t);f.prop("disabled",!1).css("cursor","pointer")}})}var e,i=[{name:"Mail API: Get messages",serviceName:"Mail",serviceEndPointUri:"https://outlook.office365.com/api/v1.0",urlpart:"/me/folders/{0}/messages",serverAction:"/GettingStarted/Proxy/EMail",authToken:"Bearer {token:https://outlook.office365.com/}",parameters:[{Name:"folder_id",Type:"string",Value:"sentitems",Notes:"The target folder ID or well-known name: Inbox, SentItems, Drafts, or DeletedItems."}]},{name:"Calendar API: Get events",serviceName:"Calendar",serviceEndPointUri:"https://outlook.office365.com/api/v1.0",urlpart:"/me/events",serverAction:"/GettingStarted/Proxy/Events",authToken:"Bearer {token:https://outlook.office365.com/}",parameters:[]},{name:"Contacts API: Get all contacts",serviceName:"Contacts",serviceEndPointUri:"https://outlook.office365.com/api/v1.0",urlpart:"/me/contacts",serverAction:"/GettingStarted/Proxy/Contacts",authToken:"Bearer {token:https://outlook.office365.com/}",parameters:[]},{name:"Files API: List folder contents",serviceName:"MyFiles",serviceEndPointUri:"https://a830edad9050849NDA1-my.sharepoint.com/_api/v1.0/me",urlpart:"/files/getByPath('{0}')/children",serverAction:"/GettingStarted/Proxy/ListFolderContents",authToken:"Bearer {token:https://a830edad9050849NDA1-my.sharepoint.com/}",parameters:[{Name:"folder-path",Type:"string",Value:"Shared%20with%20Everyone",Notes:"Path of the folder."}]},],r=n,y=t,u=$("#"+r.services),l=$("#"+r.urlValue),o=$("#"+r.responseBody),p=$("#"+r.parameterDetails),f=$("#"+r.invokeurlBtn),s=$("."+y.CodeContainer),h=$("#"+r.sandBoxOptions);w(u);u.on("change",function(){c()});h.on("change",function(){c()});f.on("click",function(){var t=l.text(),n;o.text("");n=h.val();n==="sample_data"?g(t):d()});c();$.ajax({url:"/GettingStarted/Account/IsAuthenticated",async:!0,type:"GET",success:function(n){n=="True"&&v()}})}
//# sourceMappingURL=tryitout.min.js.map
