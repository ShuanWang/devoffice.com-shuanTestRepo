function registerAppParams(){}function checkParameter(n,t,i){var r=$(n).val(),u;return r==""||typeof r===undefined?($(t).html(i),$("#register-button").attr("disabled","disabled"),$(n).addClass("highlight"),undefined):(u=new RegExp(/^.*?(?=[\^#&$\*<>\?\{\|\}]).*$/),u.test(r))?($(t).html("Parameter contains at least one invalid chars"),$(n).addClass("highlight"),undefined):($(n).removeClass("highlight"),r)}function checkProtocol(n,t,i){if(n!=""&&n!=undefined){var r=n.substr(0,7),u=n.substr(0,8);return r!="http://"&&u!="https://"?($(i).text("Wrong protocol provided in app id Uri, it should be starting with http:// or https://"),$("#register-button").attr("disabled","disabled"),$(t).addClass("highlight"),!1):($(t).hasClass("highlight")&&$(t).removeClass("highlight"),!0)}}function hideErrorDiv(n){$(n).html("");$("#register-button").removeAttr("disabled")}function registerApp(){var t,r,i,e,o;$("#reg-error_display").hide();var u=$("#appTypeField").val(),s=$("#calendarRead").is(":checked"),h=$("#contactsRead").is(":checked"),c=$("#mailRead").is(":checked"),l=$("#filesRead").is(":checked"),a=$("#calendarWrite").is(":checked"),v=$("#contactsWrite").is(":checked"),y=$("#mailWrite").is(":checked"),p=$("#filesWrite").is(":checked"),w=$("#mailSend").is(":checked"),n=!1,f=checkParameter("#appNameField","#app-name-error-div","Please enter the app name.");f!=undefined&&(t=checkParameter("#signOnUrlField","#sign-onUrl-error-div","Please enter the sign on uri."),n=checkProtocol(t,"#signOnUrlField","#sign-onUrl-error-div"),n!=!1)&&(r=checkParameter("#appIdUriField","#app-id-uri-error-div","Please enter the app id uri."),n=checkProtocol(r,"#appIdUriField","#app-id-uri-error-div"),n!=!1)&&(i=checkParameter("#redirectUriField","#redirect-uri-error-div","Please enter the redirect uri."),n=checkProtocol(i,"#redirectUriField","#redirect-uri-error-div"),n!=!1)&&(registerAppParams.signonUri=t,registerAppParams.redirectUri=i,e="/GettingStarted/AppRegistration/RegisterApp",o={appName:f,appType:u,signOnUri:t,appIdUri:r,redirectUri:i,includeCalendar:s,includeContacts:h,includeMail:c,includeFiles:l,includeCalendarWrite:a,includeContactsWrite:v,includeMailWrite:y,includeFilesWrite:p,includeMailSend:w,appId:registerAppParams.clientId},$("#register-button").attr("disabled","disabled"),$("#registration-progress").addClass("loading"),$.ajax({url:e,type:"POST",data:AddAntiForgeryToken(o),success:function(n){registerAppParams.clientId!=null?n.error_message!=undefined?$("#registration-result .ms-font-xl").html("<strong>"+n.error_message+"<\/strong>"):$("#registration-result .ms-font-xl").html("<strong>Application has been updated successfully<\/strong>"):n.client_id!=undefined&&n.client_id!=""?($("#clientIdField").val(n.client_id),u=="Native App"?$("#app-reg-client-secret").hide():$("#clientSecretField").val(n.client_secret),$("#registration-result").removeClass("hidden"),registerAppParams.clientId=n.client_id,registerAppParams.clientSecret=n.client_secret,cardTracker.removeBlockingCard(),disablePlatformSelection()):($("#reg-error_msg").text(n.error_message),$("#reg-error_display").show())},error:function(n){var t="Status Code: "+n.status+"\n\r";t+="Status Text: "+n.statusText+"\n\r";n.responseText.search("ForgeryToken")!=-1?t+="it seems that you have stale cookies, please delete the cookies, close the browser and start again.":t=n.responseText;$("#reg-error_msg").text(t);$("#reg-error_display").show()},complete:function(){$("#registration-progress").removeClass("loading");$("#register-button").removeAttr("disabled")}}))}var defaultAppIdUri=$("#appIdUriField").val();$("#appNameField").addClass("highlight");$(document).ready(function(){$("#app-reg-signin").click(function(){ga("send","event","O365path-Rest","Signin-ExistingAccount");document.cookie="current-card=register-app; path=/";window.location.href="/GettingStarted/Account/SignIn"});$("#appNameField").focusout(function(){var n=checkParameter("#appNameField","#app-name-error-div","Please enter the app name."),t;n!=undefined&&(t=$("#appIdUriField").val(),$("#appIdUriField").val(defaultAppIdUri+n))});$("#appNameField").focus(function(){hideErrorDiv("#app-name-error-div")});$("#signOnUrlField").focusout(function(){var n=checkParameter("#signOnUrlField","#sign-onUrl-error-div","Please enter the sign on uri.");checkProtocol(n,"#signOnUrlField","#sign-onUrl-error-div")});$("#signOnUrlField").focus(function(){hideErrorDiv("#sign-onUrl-error-div")});$("#appIdUriField").focusout(function(){var n=checkParameter("#appIdUriField","#app-id-uri-error-div","Please enter the app id uri.");checkProtocol(n,"#appIdUriField","#app-id-uri-error-div")});$("#appIdUriField").focus(function(){hideErrorDiv("#app-id-uri-error-div")});$("#redirectUriField").focusout(function(){var n=checkParameter("#redirectUriField","#redirect-uri-error-div","Please enter the redirect uri.");checkProtocol(n,"#redirectUriField","#redirect-uri-error-div")});$("#redirectUriField").focus(function(){hideErrorDiv("#redirect-uri-error-div")})});
//# sourceMappingURL=registerApp.min.js.map
