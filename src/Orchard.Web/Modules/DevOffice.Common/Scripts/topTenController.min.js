devOfficeApp.controller("topTenController",["$scope","$filter","$location","$timeout",function(n,t,i,r){function u(){$("#code-sample-social").attr("data-url",window.location.href);$("#sharelink-txt").val(window.location.href);f()}function f(){window.addthis&&(window.addthis=null,window._adr=null,window._atc=null,window._atd=null,window._ate=null,window._atr=null,window._atw=null);$.getScript("http://s7.addthis.com/js/300/addthis_widget.js#pubid=ra-53e944d61ebade5f").done(function(){addthis.init();addthis.toolbox("#code-sample-social");$(".social-share-container").show()})}n.selectedTypes=i.search().filters!=undefined?i.search().filters==""?[]:i.search().filters.toLowerCase().split(","):[];n.itemsToShow=[];n.itemsPerPage=15;n.pagesToShow=3;n.currentPage=1;n.model="";n.topViewedPnPs=[];n.showFirstPage=!1;n.showLastPage=!1;n.pagingRange=[];n.pnpsToShow=n.model.PatternsAndPractices;n.pageCount=function(){return Math.ceil(n.pnpsToShow.length/n.itemsPerPage)};n.sortedByHighToLow=!1;n.sortedByMostRecent=!1;n.showStartEllipsis=!1;n.showEndEllipsis=!1;n.selectedTypesCount=0;n.selectedLanguagesCount=0;n.selectedServicesCount=0;n.selectedSourcesCount=0;n.selectedPlatformsCount=0;n.selectedThemesCount=0;n.selectedSecondaryTypesCount=0;$(window).resize(function(){window.innerWidth>=900?(n.pagesToShow=5,n.handlePaging()):(n.pagesToShow=3,n.handlePaging());n.$apply()});r(function(){n.updateFilterCounts()},1e3);n.orderByViews=function(){n.sortedByHighToLow?(n.pnpsToShow.sort(function(n,t){return n.ViewCount-t.ViewCount}),n.sortedByHighToLow=!1,$("#mostPopularIcon").attr("src","/Themes/DevOffice/Content/Icons/devOffice_sort_up_grey_13x15.png"),$("#mostPopularIconxs").attr("src","/Themes/DevOffice/Content/Icons/devOffice_sort_up_orange_13x15.png")):(n.pnpsToShow.sort(function(n,t){return t.ViewCount-n.ViewCount}),n.sortedByHighToLow=!0,$("#mostPopularIcon").attr("src","/Themes/DevOffice/Content/Icons/devOffice_sort_down_grey_13x15.png"),$("#mostPopularIconxs").attr("src","/Themes/DevOffice/Content/Icons/devOffice_sort_down_orange_13x15.png"));$(".sorter.popular").addClass("active");$(".sorter.recent").removeClass("active");$("#mostRecentIcon").attr("src","/Themes/DevOffice/Content/Icons/devOffice_sort_updown_13x15.png");$("#mostRecentIconxs").attr("src","/Themes/DevOffice/Content/Icons/devOffice_sort_updown_13x15.png");n.updatePagination(1)};n.orderByDate=function(){n.sortedByMostRecent?(n.pnpsToShow.sort(function(n,t){return parseInt(n.UpdatedDate.substr(6))-parseInt(t.UpdatedDate.substr(6))}),n.sortedByMostRecent=!1,$("#mostRecentIcon").attr("src","/Themes/DevOffice/Content/Icons/devOffice_sort_up_grey_13x15.png"),$("#mostRecentIconxs").attr("src","/Themes/DevOffice/Content/Icons/devOffice_sort_up_orange_13x15.png")):(n.pnpsToShow.sort(function(n,t){return parseInt(t.UpdatedDate.substr(6))-parseInt(n.UpdatedDate.substr(6))}),n.sortedByMostRecent=!0,$("#mostRecentIcon").attr("src","/Themes/DevOffice/Content/Icons/devOffice_sort_down_grey_13x15.png"),$("#mostRecentIconxs").attr("src","/Themes/DevOffice/Content/Icons/devOffice_sort_down_orange_13x15.png"));$(".sorter.recent").addClass("active");$(".sorter.popular").removeClass("active");$("#mostPopularIcon").attr("src","/Themes/DevOffice/Content/Icons/devOffice_sort_updown_13x15.png");$("#mostPopularIconxs").attr("src","/Themes/DevOffice/Content/Icons/devOffice_sort_updown_13x15.png");n.updatePagination(1)};n.handlePaging=function(){var i,r,t;if(n.pagingRange=[],n.showFirstPage=!1,n.showLastPage=!1,n.showStartEllipsis=!1,n.showEndEllipsis=!1,n.pageCount()>n.pagesToShow){for(i=n.currentPage-Math.floor(n.pagesToShow/2),r=n.currentPage+Math.floor(n.pagesToShow/2);i<1;)i++,r++;while(r>n.pageCount())i--,r--;for(r<n.pageCount()&&(n.showLastPage=!0,r<n.pageCount()-1&&(n.showEndEllipsis=!0)),i>1&&(n.showFirstPage=!0,i>2&&(n.showStartEllipsis=!0)),t=i;t<=r;t++)n.pagingRange.push(t)}else for(t=1;t<=n.pageCount();t++)n.pagingRange.push(t)};n.$watch("model",function(){n.pnpsToShow.length==0&&(n.pnpsToShow=n.model.PatternsAndPractices);n.currListSlice=n.pnpsToShow.slice(0,n.itemsPerPage);n.orderByViews();n.handlePaging();for(var t=0,i=n.model.PatternsAndPractices.length;t<i;t++)n.model.PatternsAndPractices[t].TechnicalTitle=n.model.PatternsAndPractices[t].Title.replace(/ /g,"")+"-DetailLink",n.model.PatternsAndPractices[t].External=n.model.PatternsAndPractices[t].ExternalLink.indexOf(window.location.host)!=-1||n.model.PatternsAndPractices[t].ExternalLink.startsWith("patterns-and-practices")?"":"_external",n.model.TopViewed.indexOf(n.model.PatternsAndPractices[t].Id)!=-1&&n.topViewedPnPs.push(n.model.PatternsAndPractices[t]);n.pagesToShow=window.innerWidth>=900?5:3;n.handlePaging();$("#code-sample-social").attr("data-url",window.location.href);$("#sharelink-txt").val(window.location.href)});n.updateSearchResults=function(){n.getPnpsOfSelectedTypes();var i=t("filter")(n.pnpsToShow,n.searchText);u();n.pnpsToShow=i;n.updatePagination(1)};n.$watch("searchText",function(){n.updateSearchResults()});n.updateViewCount=function(t,i){n.date=new Date;$.ajax("/devoffice.common/viewCount/post?itemid="+t+"&type="+i).error(function(){console.log("Unable to log view for item "+t)}).success(function(){})};n.updatePagination=function(t){n.currentPage=t;var i=(n.currentPage-1)*n.itemsPerPage;n.currListSlice=n.pnpsToShow.slice(i,i+n.itemsPerPage);n.handlePaging()};n.updateSelectedTypes=function(t){var r=n.selectedTypes.indexOf(t.toLowerCase());r>-1?n.selectedTypes.splice(r,1):n.selectedTypes.push(t.toLowerCase());i.search("filters",n.selectedTypes.join(","));n.$apply();n.getPnpsOfSelectedTypes();n.updatePagination(1);n.updateFilterCounts();u()};n.getPnpsOfSelectedTypes=function(){n.pnpsToShow=n.selectedTypes.length==0?n.model.PatternsAndPractices:[];$.each(n.model.PatternsAndPractices,function(){var t=!1;$.each(this.PatternsAndPracticesTypes,function(i,r){n.selectedTypes.indexOf(r)>-1&&(t=!0)});t&&n.pnpsToShow.indexOf(this)==-1&&n.pnpsToShow.push(this)})};n.clearFilters=function(){n.selectedTypes=[];n.updateSearchResults();$("input:checkbox").prop("checked",!1);n.updateFilterCounts();i.search("filters",n.selectedTypes.join(","))};n.updateFilterCounts=function(){n.selectedLanguagesCount=$("#languages input:checkbox:checked").length;n.selectedProductsCount=$("#products input:checkbox:checked").length;n.selectedSourcesCount=$("#sources input:checkbox:checked").length;n.selectedPlatformsCount=$("#platforms input:checkbox:checked").length;n.selectedServicesCount=$("#services input:checkbox:checked").length;n.selectedTypesCount=$("#types input:checkbox:checked").length;n.selectedThemesCount=$("#themes input:checkbox:checked").length;n.selectedSecondaryTypesCount=$("#secondary-types input:checkbox:checked").length};$(".share-button").click(function(n){n.preventDefault();$(".sharelink-container").css("display")=="none"?$(".sharelink-container").css("display","block"):$(".sharelink-container").css("display","none");$(this).val()!="Choose filters and hit apply"&&($(this).focus(),$(this).select(),u())})}]);
//# sourceMappingURL=topTenController.min.js.map
